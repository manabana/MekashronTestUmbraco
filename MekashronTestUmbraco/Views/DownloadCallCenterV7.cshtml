@using Umbraco.Cms.Web.Common.PublishedModels;
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage

@{
    Guid indexPageId = Guid.Parse("41e0ccdd-4a1d-4aa8-a022-abc7d5555024");
    IPublishedContent? indexPage = Umbraco.Content(indexPageId);
    if (indexPage is null) throw new Exception("index page not found");
}

@functions {
    public IHtmlContent ParseLinks(String? input)
    {
        if (String.IsNullOrWhiteSpace(input))
            return HtmlString.Empty;

        var regex = new System.Text.RegularExpressions.Regex(
            @"\{link\s+""([^""]+)""(?:\s+""([^""]*)"")?\}",
            System.Text.RegularExpressions.RegexOptions.IgnoreCase
        );

        var result = regex.Replace(input, match =>
        {
            var text = match.Groups[1].Value;
            var href = match.Groups[2].Success ? match.Groups[2].Value : "";

            return $"<a class=\"link\" href=\"{System.Net.WebUtility.HtmlEncode(href)}\">{System.Net.WebUtility.HtmlEncode(text)}</a>";
        });

        return new HtmlString(result);
    }
}


<!DOCTYPE html>
<html lang="en">

@await Html.PartialAsync("Partials/Head")

<body>
    <div class="site" id="page">

        @await Html.PartialAsync("Partials/Header")

        <main class="main" id="primary">
        <div style="height: 100%" class="container">
            <section class="breadcrumbs" style="background-image: none;">
                <div class="container">
                    <h1 style="text-align: center; ">@Model.Value("thanks")</h1>
                </div>
            </section>

            <p style="text-align: center;">
                @ParseLinks(Model.Value("text1")?.ToString())
            </p>

            <p style ="text-align: center;">
                @ParseLinks(Model.Value("text2")?.ToString())
            </p>

            <p style="text-align: center;">
                @ParseLinks(Model.Value("text3")?.ToString())
            </p>
        </div>
        </main>

	    @await Html.PartialAsync("Partials/Footer")

    </div>

    <script src="@(Url.Content("~/assets/js/jquery-3.7.1.min.js"))"></script>
    <script src="@(Url.Content("~/assets/js/swiper-bundle.min.js"))"></script>
    <script src="@(Url.Content("~/assets/js/select.js"))"></script>
    <script src="@(Url.Content("~/assets/js/scripts.js"))"></script>


    <script>
        async function downloadFile(url) {
            const res = await fetch(url, { method: 'GET' });

            if (!res.ok) {
                throw new Error('downloading failed');
            }

            const blob = await res.blob();
            const downloadUrl = window.URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = downloadUrl;

            a.download = 'mekashronCallCenterV7.exe';

            document.body.appendChild(a);
            a.click();

            a.remove();
            window.URL.revokeObjectURL(downloadUrl);
        }
    </script>

</body>

</html>